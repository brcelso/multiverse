---
- name: Script Deploy
  hosts: localhost
  become: true
  vars:
    apt_file: /etc/apt/sources.list.d/google-chrome.list
  tasks:

    - name: Verificar se o arquivo apt do Google Chrome existe
      command: test -f {{ apt_file }}
      register: google_apt_exists
      ignore_errors: true

    - name: Adicionar chave do Google Chrome
      shell: wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -
      when: google_apt_exists.rc == 1

    - name: Adicionar reposit√≥rio do Google Chrome
      copy:
        content: "deb http://dl.google.com/linux/chrome/deb/ stable main"
        dest: "{{ apt_file }}"
        owner: root
        group: root
        mode: 0644
      when: google_apt_exists.rc == 1

    - name: Atualizar cache do apt
      apt:
        update_cache: yes
      when: google_apt_exists.rc == 1

    - name: Instalar o Google Chrome
      apt:
        pkg: google-chrome-stable
        state: present
